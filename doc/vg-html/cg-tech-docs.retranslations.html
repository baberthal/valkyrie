<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>2.5. Handling basic block retranslations</title>
<link rel="stylesheet" href="vg_basic.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.64.1">
<link rel="home" href="index.html" title="Valgrind Documentation">
<link rel="up" href="cg-tech-docs.html" title="2. How Cachegrind works">
<link rel="previous" href="cg-tech-docs.instrum.html" title="2.4. Instrumentation">
<link rel="next" href="cg-tech-docs.cachesim.html" title="2.6. The cache simulation">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div><table class="nav" width="100%" cellspacing="3" cellpadding="3" border="0" summary="Navigation header"><tr>
<td width="22px" align="center" valign="middle"><a accesskey="p" href="cg-tech-docs.instrum.html"><img src="images/prev.png" width="18" height="21" border="0" alt="Prev"></a></td>
<td width="25px" align="center" valign="middle"><a accesskey="u" href="cg-tech-docs.html"><img src="images/up.png" width="21" height="18" border="0" alt="Up"></a></td>
<td width="31px" align="center" valign="middle"><a accesskey="h" href="index.html"><img src="images/home.png" width="27" height="20" border="0" alt="Up"></a></td>
<th align="center" valign="middle">2. How Cachegrind works</th>
<td width="22px" align="center" valign="middle"><a accesskey="n" href="cg-tech-docs.cachesim.html"><img src="images/next.png" width="18" height="21" border="0" alt="Next"></a></td>
</tr></table></div>
<div class="sect1" lang="en">
<div class="titlepage">
<div><div><h2 class="title" style="clear: both">
<a name="cg-tech-docs.retranslations"></a>2.5. Handling basic block retranslations</h2></div></div>
<div></div>
</div>
<p>The above description ignores one complication.  Valgrind
has a limited size cache for basic block translations; if it
fills up, old translations are discarded.  If a discarded basic
block is executed again, it must be re-translated.</p>
<p>However, we can't use this approach for profiling -- we
can't throw away cost centres for instructions in the middle of
execution!  So when a basic block is translated, we first look
for its cost centre array in the hash table.  If there is no cost
centre array, it must be the first translation, so we proceed as
described above.  But if there is a cost centre array already, it
must be a retranslation.  In this case, we skip the cost centre
allocation and initialisation steps, but still do the UCode
instrumentation step.</p>
</div>
<div>
<br><table class="nav" width="100%" cellspacing="3" cellpadding="2" border="0" summary="Navigation footer">
<tr>
<td rowspan="2" width="40%" align="left">
<a accesskey="p" href="cg-tech-docs.instrum.html">&lt;&lt; 2.4. Instrumentation</a> </td>
<td width="20%" align="center"><a accesskey="u" href="cg-tech-docs.html">Up</a></td>
<td rowspan="2" width="40%" align="right"> <a accesskey="n" href="cg-tech-docs.cachesim.html">2.6. The cache simulation &gt;&gt;</a>
</td>
</tr>
<tr><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td></tr>
</table>
</div>
</body>
</html>
