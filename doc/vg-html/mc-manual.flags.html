<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>3.2. Command-line flags specific to memcheck</title>
<link rel="stylesheet" href="vg_basic.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.64.1">
<link rel="home" href="index.html" title="Valgrind Documentation">
<link rel="up" href="mc-manual.html" title="3. Memcheck: a heavyweight memory checker">
<link rel="previous" href="mc-manual.html" title="3. Memcheck: a heavyweight memory checker">
<link rel="next" href="mc-manual.errormsgs.html" title="3.3. Explanation of error messages from Memcheck">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div><table class="nav" width="100%" cellspacing="3" cellpadding="3" border="0" summary="Navigation header"><tr>
<td width="22px" align="center" valign="middle"><a accesskey="p" href="mc-manual.html"><img src="images/prev.png" width="18" height="21" border="0" alt="Prev"></a></td>
<td width="25px" align="center" valign="middle"><a accesskey="u" href="mc-manual.html"><img src="images/up.png" width="21" height="18" border="0" alt="Up"></a></td>
<td width="31px" align="center" valign="middle"><a accesskey="h" href="index.html"><img src="images/home.png" width="27" height="20" border="0" alt="Up"></a></td>
<th align="center" valign="middle">3. Memcheck: a heavyweight memory checker</th>
<td width="22px" align="center" valign="middle"><a accesskey="n" href="mc-manual.errormsgs.html"><img src="images/next.png" width="18" height="21" border="0" alt="Next"></a></td>
</tr></table></div>
<div class="sect1" lang="en">
<div class="titlepage">
<div><div><h2 class="title" style="clear: both">
<a name="mc-manual.flags"></a>3.2. Command-line flags specific to memcheck</h2></div></div>
<div></div>
</div>
<div class="itemizedlist">
<a name="leakcheck"></a><ul type="disc">
<li>
<p><tt class="computeroutput">--leak-check=no</tt>
    [default]</p>
<p><tt class="computeroutput">--leak-check=yes</tt></p>
<p>When enabled, search for memory leaks when the client
    program finishes.  A memory leak means a malloc'd block,
    which has not yet been free'd, but to which no pointer can be
    found.  Such a block can never be free'd by the program,
    since no pointer to it exists.  Leak checking is disabled by
    default because it tends to generate dozens of error
    messages.</p>
</li>
<li>
<p><a name="showreach"></a><tt class="computeroutput">--show-reachable=no</tt>
    [default]</p>
<p><tt class="computeroutput">--show-reachable=yes</tt></p>
<p>When disabled, the memory leak detector only shows
    blocks for which it cannot find a pointer to at all, or it
    can only find a pointer to the middle of.  These blocks are
    prime candidates for memory leaks.  When enabled, the leak
    detector also reports on blocks which it could find a pointer
    to.  Your program could, at least in principle, have freed
    such blocks before exit.  Contrast this to blocks for which
    no pointer, or only an interior pointer could be found: they
    are more likely to indicate memory leaks, because you do not
    actually have a pointer to the start of the block which you
    can hand to <tt class="computeroutput">free</tt>, even if
    you wanted to.</p>
</li>
<li>
<p><a name="leakres"></a><tt class="computeroutput">--leak-resolution=low</tt>
    [default]</p>
<p><tt class="computeroutput">--leak-resolution=med</tt></p>
<p><tt class="computeroutput">--leak-resolution=high</tt></p>
<p>When doing leak checking, determines how willing
    Memcheck is to consider different backtraces to be the same.
    When set to <tt class="computeroutput">low</tt>, the
    default, only the first two entries need match.  When
    <tt class="computeroutput">med</tt>, four entries have to
    match.  When <tt class="computeroutput">high</tt>, all
    entries need to match.</p>
<p>For hardcore leak debugging, you probably want to use
    <tt class="computeroutput">--leak-resolution=high</tt>
    together with
    <tt class="computeroutput">--num-callers=40</tt> or some
    such large number.  Note however that this can give an
    overwhelming amount of information, which is why the defaults
    are 4 callers and low-resolution matching.</p>
<p>Note that the
    <tt class="computeroutput">--leak-resolution=</tt> setting
    does not affect Memcheck's ability to find leaks.  It only
    changes how the results are presented.</p>
</li>
<li>
<p><a name="freelist"></a><tt class="computeroutput">--freelist-vol=&lt;number&gt;</tt>
    [default: 1000000]</p>
<p>When the client program releases memory using free (in
    <tt class="literal">C</tt>) or delete (<tt class="literal">C++</tt>),
    that memory is not immediately made available for
    re-allocation.  Instead it is marked inaccessible and placed
    in a queue of freed blocks.  The purpose is to delay the
    point at which freed-up memory comes back into circulation.
    This increases the chance that Memcheck will be able to
    detect invalid accesses to blocks for some significant period
    of time after they have been freed.</p>
<p>This flag specifies the maximum total size, in bytes,
    of the blocks in the queue.  The default value is one million
    bytes.  Increasing this increases the total amount of memory
    used by Memcheck but may detect invalid uses of freed blocks
    which would otherwise go undetected.</p>
</li>
<li>
<p><a name="gcc296"></a><tt class="computeroutput">--workaround-gcc296-bugs=no</tt>
    [default]</p>
<p><tt class="computeroutput">--workaround-gcc296-bugs=yes</tt></p>
<p>When enabled, assume that reads and writes some small
    distance below the stack pointer
    <tt class="computeroutput">%esp</tt> are due to bugs in gcc
    2.96, and does not report them.  The "small distance" is 256
    bytes by default.  Note that gcc 2.96 is the default compiler
    on some popular Linux distributions (RedHat 7.X, Mandrake)
    and so you may well need to use this flag.  Do not use it if
    you do not have to, as it can cause real errors to be
    overlooked.  Another option is to use a gcc/g++ which does
    not generate accesses below the stack pointer.  2.95.3 seems
    to be a good choice in this respect.</p>
<p>Unfortunately (27 Feb 02) it looks like g++ 3.0.4 has a
    similar bug, so you may need to issue this flag if you use
    3.0.4.  A while later (early Apr 02) this is confirmed as a
    scheduling bug in g++-3.0.4.</p>
</li>
<li>
<p><a name="partial"></a><tt class="computeroutput">--partial-loads-ok=yes</tt>
    [default]</p>
<p><tt class="computeroutput">--partial-loads-ok=no</tt></p>
<p>Controls how Memcheck handles word (4-byte) loads from
    addresses for which some bytes are addressible and others are
    not.  When <tt class="computeroutput">yes</tt> (the
    default), such loads do not elicit an address error.
    Instead, the loaded V bytes corresponding to the illegal
    addresses indicate undefined, and those corresponding to
    legal addresses are loaded from shadow memory, as usual.</p>
<p>When <tt class="computeroutput">no</tt>, loads from
    partially invalid addresses are treated the same as loads
    from completely invalid addresses: an illegal-address error
    is issued, and the resulting V bytes indicate valid data.</p>
</li>
<li>
<p><a name="strlen"></a><tt class="computeroutput">--avoid-strlen-errors=no</tt></p>
<p><tt class="computeroutput">--avoid-strlen-errors=yes</tt> [default]</p>
<p>Enable or disable a heuristic for dealing with highly-optimized 
    versions of strlen.  These versions of strlen can cause spurious errors 
    to be reported by memcheck, so it's usually a good idea to leave this
    enabled.</p>
</li>
<li>
<p><a name="cleanup"></a><tt class="computeroutput">--cleanup=no</tt></p>
<p><tt class="computeroutput">--cleanup=yes</tt> [default]</p>
<p><span><b class="command">This is a flag to help debug valgrind itself.
    It is of no use to end-users.</b></span> When enabled, various
    improvments are applied to the post-instrumented intermediate
    code, aimed at removing redundant value checks.</p>
</li>
</ul>
</div>
</div>
<div>
<br><table class="nav" width="100%" cellspacing="3" cellpadding="2" border="0" summary="Navigation footer">
<tr>
<td rowspan="2" width="40%" align="left">
<a accesskey="p" href="mc-manual.html">&lt;&lt; 3. Memcheck: a heavyweight memory checker</a> </td>
<td width="20%" align="center"><a accesskey="u" href="mc-manual.html">Up</a></td>
<td rowspan="2" width="40%" align="right"> <a accesskey="n" href="mc-manual.errormsgs.html">3.3. Explanation of error messages from Memcheck &gt;&gt;</a>
</td>
</tr>
<tr><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td></tr>
</table>
</div>
</body>
</html>
